# ğŸ¨ BrandaoZap Frontend - Regras e Boas PrÃ¡ticas

## ğŸ“‹ Arquitetura

### Estrutura de Pastas (Next.js 14+ App Router)

```
src/
â”œâ”€â”€ app/                       # App Router (Next.js 14+)
â”‚   â”œâ”€â”€ layout.tsx            # Layout raiz
â”‚   â”œâ”€â”€ page.tsx              # Home page
â”‚   â”œâ”€â”€ (auth)/               # Route group para autenticaÃ§Ã£o
â”‚   â”‚   â”œâ”€â”€ login/
â”‚   â”‚   â””â”€â”€ register/
â”‚   â”œâ”€â”€ (dashboard)/          # Route group para dashboard
â”‚   â”‚   â”œâ”€â”€ layout.tsx        # Layout do dashboard
â”‚   â”‚   â”œâ”€â”€ dashboard/
â”‚   â”‚   â”œâ”€â”€ whatsapp/
â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx      # Lista de sessÃµes
â”‚   â”‚   â”‚   â””â”€â”€ [sessionId]/
â”‚   â”‚   â”‚       â””â”€â”€ page.tsx  # Detalhes da sessÃ£o
â”‚   â”‚   â”œâ”€â”€ flows/
â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx      # Lista de fluxos
â”‚   â”‚   â”‚   â”œâ”€â”€ new/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx  # Criar fluxo
â”‚   â”‚   â”‚   â””â”€â”€ [id]/
â”‚   â”‚   â”‚       â””â”€â”€ page.tsx  # Editar fluxo
â”‚   â”‚   â”œâ”€â”€ contacts/
â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx
â”‚   â”‚   â”‚   â””â”€â”€ [id]/
â”‚   â”‚   â”œâ”€â”€ campaigns/
â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx
â”‚   â”‚   â”‚   â””â”€â”€ [id]/
â”‚   â”‚   â”œâ”€â”€ templates/
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”‚   â””â”€â”€ chat/
â”‚   â”‚       â””â”€â”€ [chatId]/
â”‚   â”‚           â””â”€â”€ page.tsx
â”‚   â””â”€â”€ api/                   # API Routes (se necessÃ¡rio)
â”œâ”€â”€ components/                # Componentes React
â”‚   â”œâ”€â”€ ui/                    # Componentes base (shadcn/ui)
â”‚   â”‚   â”œâ”€â”€ button/
â”‚   â”‚   â”œâ”€â”€ input/
â”‚   â”‚   â”œâ”€â”€ card/
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ layout/                # Componentes de layout
â”‚   â”‚   â”œâ”€â”€ Header/
â”‚   â”‚   â”œâ”€â”€ Sidebar/
â”‚   â”‚   â””â”€â”€ Footer/
â”‚   â”œâ”€â”€ whatsapp/              # Componentes especÃ­ficos WhatsApp
â”‚   â”‚   â”œâ”€â”€ QRCodeScanner/
â”‚   â”‚   â”œâ”€â”€ SessionCard/
â”‚   â”‚   â””â”€â”€ MessageList/
â”‚   â”œâ”€â”€ flows/                 # Componentes de fluxos
â”‚   â”‚   â”œâ”€â”€ FlowBuilder/
â”‚   â”‚   â”œâ”€â”€ FlowNode/
â”‚   â”‚   â””â”€â”€ FlowCanvas/
â”‚   â”œâ”€â”€ contacts/              # Componentes de contatos
â”‚   â”œâ”€â”€ campaigns/             # Componentes de campanhas
â”‚   â””â”€â”€ chat/                  # Componentes de chat
â”‚       â”œâ”€â”€ ChatWindow/
â”‚       â”œâ”€â”€ MessageBubble/
â”‚       â””â”€â”€ ChatInput/
â”œâ”€â”€ lib/                       # UtilitÃ¡rios e configuraÃ§Ãµes
â”‚   â”œâ”€â”€ api/                   # Cliente API
â”‚   â”‚   â”œâ”€â”€ client.ts
â”‚   â”‚   â”œâ”€â”€ endpoints.ts
â”‚   â”‚   â””â”€â”€ types.ts
â”‚   â”œâ”€â”€ hooks/                 # Custom hooks
â”‚   â”‚   â”œâ”€â”€ useWebSocket.ts
â”‚   â”‚   â”œâ”€â”€ useWhatsApp.ts
â”‚   â”‚   â””â”€â”€ useAuth.ts
â”‚   â”œâ”€â”€ utils/                 # FunÃ§Ãµes utilitÃ¡rias
â”‚   â”‚   â”œâ”€â”€ format.ts
â”‚   â”‚   â”œâ”€â”€ validation.ts
â”‚   â”‚   â””â”€â”€ constants.ts
â”‚   â””â”€â”€ store/                 # Estado global (Zustand/Redux)
â”‚       â”œâ”€â”€ auth.store.ts
â”‚       â”œâ”€â”€ whatsapp.store.ts
â”‚       â””â”€â”€ chat.store.ts
â”œâ”€â”€ types/                     # TypeScript types
â”‚   â”œâ”€â”€ api.types.ts
â”‚   â”œâ”€â”€ whatsapp.types.ts
â”‚   â””â”€â”€ flow.types.ts
â””â”€â”€ styles/                    # Estilos globais
    â””â”€â”€ globals.css
```

## ğŸ¯ PrincÃ­pios e Regras

### 1. **Componentes**
- âœ… Componentes funcionais com hooks
- âœ… Um componente por arquivo
- âœ… Nomes em PascalCase
- âœ… Props tipadas com TypeScript
- âœ… Componentes pequenos e reutilizÃ¡veis
- âœ… SeparaÃ§Ã£o de lÃ³gica e apresentaÃ§Ã£o

### 2. **Estado**
- âœ… Estado local com `useState` quando apropriado
- âœ… Estado global com Zustand ou Context API
- âœ… Server state com React Query/TanStack Query
- âœ… Evitar prop drilling excessivo

### 3. **Data Fetching**
- âœ… Usar React Query para requisiÃ§Ãµes HTTP
- âœ… Cache automÃ¡tico e invalidaÃ§Ã£o
- âœ… Loading e error states
- âœ… Otimistic updates quando apropriado
- âœ… Server Components quando possÃ­vel (Next.js)

### 4. **FormulÃ¡rios**
- âœ… Usar React Hook Form para formulÃ¡rios
- âœ… ValidaÃ§Ã£o com Zod ou Yup
- âœ… Feedback visual de erros
- âœ… Estados de loading durante submit

### 5. **EstilizaÃ§Ã£o**
- âœ… Tailwind CSS como base
- âœ… Componentes do shadcn/ui
- âœ… Design system consistente
- âœ… Responsive design mobile-first
- âœ… Dark mode support

### 6. **TypeScript**
- âœ… TypeScript strict mode
- âœ… Tipos explÃ­citos, evitar `any`
- âœ… Interfaces para props e dados
- âœ… Types para unions e literals
- âœ… Generics quando apropriado

### 7. **Performance**
- âœ… Lazy loading de componentes pesados
- âœ… `React.memo` para componentes puros
- âœ… `useMemo` e `useCallback` quando necessÃ¡rio
- âœ… Code splitting automÃ¡tico (Next.js)
- âœ… Imagens otimizadas com `next/image`
- âœ… VirtualizaÃ§Ã£o para listas longas

### 8. **WebSockets**
- âœ… Custom hook para WebSocket
- âœ… ReconexÃ£o automÃ¡tica
- âœ… Gerenciamento de conexÃµes
- âœ… Cleanup adequado em unmount

### 9. **AutenticaÃ§Ã£o**
- âœ… JWT armazenado em httpOnly cookies
- âœ… Refresh token automÃ¡tico
- âœ… ProteÃ§Ã£o de rotas
- âœ… Redirect apÃ³s login/logout

### 10. **Construtor de Fluxos**
- âœ… Biblioteca: React Flow ou React DnD
- âœ… Drag and drop funcional
- âœ… ValidaÃ§Ã£o de conexÃµes
- âœ… Preview de fluxo
- âœ… Export/Import de fluxos

### 11. **Chat em Tempo Real**
- âœ… WebSocket para mensagens
- âœ… Scroll automÃ¡tico para Ãºltima mensagem
- âœ… Indicadores de digitaÃ§Ã£o
- âœ… Status de entrega/leitura
- âœ… Suporte a mÃ­dia (imagens, Ã¡udio, vÃ­deo)

### 12. **QR Code Scanner**
- âœ… Biblioteca: `qrcode.react` ou `react-qr-reader`
- âœ… Auto-refresh quando desconectado
- âœ… Feedback visual de status
- âœ… HistÃ³rico de conexÃµes

### 13. **ValidaÃ§Ã£o**
- âœ… ValidaÃ§Ã£o client-side com Zod
- âœ… ValidaÃ§Ã£o server-side (backend)
- âœ… Mensagens de erro claras
- âœ… ValidaÃ§Ã£o em tempo real

### 14. **Acessibilidade**
- âœ… SemÃ¢ntica HTML adequada
- âœ… ARIA labels quando necessÃ¡rio
- âœ… NavegaÃ§Ã£o por teclado
- âœ… Contraste adequado
- âœ… Screen reader friendly

### 15. **Error Handling**
- âœ… Error boundaries para erros React
- âœ… Try/catch em async operations
- âœ… Mensagens de erro user-friendly
- âœ… Logging de erros (Sentry ou similar)
- âœ… Fallback UI para erros

### 16. **Testes**
- âœ… Unit tests com Vitest
- âœ… Component tests com React Testing Library
- âœ… E2E tests com Playwright
- âœ… Testes de integraÃ§Ã£o

### 17. **SEO**
- âœ… Metadata adequada
- âœ… Open Graph tags
- âœ… Sitemap.xml
- âœ… robots.txt

### 18. **Code Quality**
- âœ… ESLint configurado
- âœ… Prettier para formataÃ§Ã£o
- âœ… Husky para pre-commit hooks
- âœ… Commits semÃ¢nticos

## ğŸ“¦ DependÃªncias Recomendadas

```json
{
  "next": "^14.0.0",
  "react": "^19.0.0",
  "react-dom": "^19.0.0",
  "@tanstack/react-query": "^5.0.0",
  "zustand": "^4.4.0",
  "react-hook-form": "^7.48.0",
  "zod": "^3.22.0",
  "@hookform/resolvers": "^3.3.0",
  "reactflow": "^11.10.0",
  "socket.io-client": "^4.5.0",
  "axios": "^1.6.0",
  "date-fns": "^2.30.0",
  "clsx": "^2.0.0",
  "tailwind-merge": "^2.0.0",
  "lucide-react": "^0.300.0",
  "@radix-ui/react-dialog": "^1.0.0",
  "@radix-ui/react-dropdown-menu": "^2.0.0",
  "class-variance-authority": "^0.7.0"
}
```

## ğŸ¨ Design System

### Cores Principais
- Primary: WhatsApp Green (#25D366)
- Secondary: Dark Green (#128C7E)
- Background: Light Gray (#F0F2F5)
- Text: Dark Gray (#1F2937)

### Componentes Base
- Usar shadcn/ui como base
- Customizar para identidade visual
- Manter consistÃªncia

## ğŸ”„ Fluxo de Desenvolvimento

1. **Criar pÃ¡gina**: Adicionar em `app/`
2. **Criar componente**: Adicionar em `components/`
3. **Criar hook**: Adicionar em `lib/hooks/`
4. **Criar tipo**: Adicionar em `types/`
5. **Testar**: `pnpm test`
6. **Rodar**: `pnpm dev`

## ğŸš« Anti-patterns a Evitar

- âŒ Estado global desnecessÃ¡rio
- âŒ Efeitos colaterais em render
- âŒ MutaÃ§Ã£o direta de estado
- âŒ Props drilling excessivo
- âŒ Componentes muito grandes
- âŒ LÃ³gica de negÃ³cio em componentes
- âŒ RequisiÃ§Ãµes em loops
- âŒ DependÃªncias nÃ£o otimizadas
- âŒ Imagens nÃ£o otimizadas
- âŒ CSS inline excessivo

## ğŸ“± Responsividade

- Mobile: < 640px
- Tablet: 640px - 1024px
- Desktop: > 1024px
- Testar em todos os breakpoints

## ğŸ” SeguranÃ§a

- âœ… Validar inputs no client e server
- âœ… Sanitizar dados antes de exibir
- âœ… HTTPS obrigatÃ³rio
- âœ… NÃ£o expor tokens em client-side
- âœ… CSRF protection
- âœ… XSS prevention
